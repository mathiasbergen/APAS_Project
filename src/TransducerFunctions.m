classdef TransducerFunctions < TransmAndReflCoeff
    
    properties (Access=public)
        b;
        a;
        z;
    end
    
    methods
        function obj = TransducerFunctions(a,r,z,f)   % contructor
            obj@TransmAndReflCoeff(f); % invoking the superclass constructor
            obj.b = r;
            obj.z = z;
            obj.a = a;
        end
        function g_fun = g_FilonEchoAll(obj,eta)
            z_fluid = obj.z1*2-obj.z;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            g_fun = -h_fz.*(-z_fluid);
        end
        function g_fun = g_FilonTransmAll(obj,eta)
            z_fluid = obj.z-obj.d;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            g_fun = -h_fz.*(-z_fluid);
        end
        function g_fun = g_FilonFreeField(obj,eta)
            z_fluid = obj.z;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            g_fun = -h_fz.*(-z_fluid);
        end
        function f_fun = f_FilonEcho(obj,eta)
            b = obj.b;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            R = obj.ReflectionCoeff(eta);
            f_fun = (R.*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function f_fun = f_FilonEcho1(obj,eta)
            b = obj.b;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            R = obj.ReflectionCoeffNoRefl(eta);
            f_fun = (R.*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function f_fun = f_FilonEcho2(obj,eta)
            b = obj.b;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            R = obj.ReflectionCoeffNoRefl2(eta);
            f_fun = (R.*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function f_fun = f_FilonTransm(obj,eta)
            a = obj.a;
            b = obj.b;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            T = obj.TransmissionCoeff(eta);
            f_fun = (T.*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function f_fun = f_FilonTransm1(obj,eta)
            a = obj.a;
            b = obj.b;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            T = obj.TransmissionCoeffNoRefl(eta);
            f_fun = (T.*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function f_fun = f_FilonTransm2(obj,eta)
            a = obj.a;
            b = obj.b;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            T = obj.TransmissionCoeffNoRefl2(eta);
            f_fun = (T.*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function f_fun = f_FilonFreefield(obj,eta)
            a = obj.a;
            b = obj.b;
            z = obj.z;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            f_fun = (besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        
        function out = integrandGaussEcho(obj,eta)
            a = obj.a;
            b = obj.b;
            z_fluid = obj.z1*2-obj.z;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            R = obj.ReflectionCoeff(eta);
            out = (R.*exp(-h_fz.*z_fluid.*1i).*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function out = integrandGaussEcho1(obj,eta)
            a = obj.a;
            b = obj.b;
            z_fluid = obj.z1*2-obj.z;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            R = obj.ReflectionCoeffNoRefl(eta);
            out = (R.*exp(-h_fz.*z_fluid.*1i).*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function out = integrandGaussEcho2(obj,eta)
            a = obj.a;
            b = obj.b;
            z_fluid = obj.z1*2-obj.z;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            R = obj.ReflectionCoeffNoRefl2(eta);
            out = (R.*exp(-h_fz.*z_fluid.*1i).*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        
        function out = integrandGaussTransm(obj,eta)
            a = obj.a;
            b = obj.b;
            z_fluid = obj.z-obj.d;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            T = obj.TransmissionCoeff(eta);
            out = (T.*exp(h_fz.*(-z_fluid).*1i).*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function out = integrandGaussTransm1(obj,eta)
            a = obj.a;
            b = obj.b;
            z_fluid = obj.z-obj.d;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            T = obj.TransmissionCoeffNoRefl(eta);
            out = (T.*exp(h_fz.*(-z_fluid).*1i).*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function out = integrandGaussTransm2(obj,eta)
            a = obj.a;
            b = obj.b;
            z_fluid = obj.z-obj.d;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            T = obj.TransmissionCoeffNoRefl2(eta);
            out = (T.*exp(h_fz.*(-z_fluid).*1i).*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function out = integrandGaussFreefield(obj,eta)
            a = obj.a;
            b = obj.b;
            z_fluid = obj.z;
            h_fz = (-i.*(-( obj.h_f.^2-eta.^2)) .^(1/2));
            out = (exp(h_fz.*z_fluid.*-1i).*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*h_fz);
        end
        function out = integrandPartsGaussFreefield(obj,eta)
            a = obj.a;
            b = obj.b;
            z_fluid = obj.z;
            h_f = obj.h_f;
            out = (1.0./eta.^3.*exp(-z_fluid.*sqrt(eta.^2-h_f.^2)).*(-(eta.^2.*z_fluid.*1i+sqrt(eta.^2-h_f.^2).*4.0i).*besselj(1,a.*eta).*besselj(1,b.*eta)+a.*eta.*sqrt(eta.^2-h_f.^2).*besselj(0,a.*eta).*besselj(1,b.*eta).*1i+b.*eta.*sqrt(eta.^2-h_f.^2).*besselj(1,a.*eta).*besselj(0,b.*eta).*1i).*2.0)./b;
        end
        function out = termPartsGaussFreefield(obj,eta)
            a = obj.a;
            b = obj.b;
            z_fluid = obj.z;
            h_f = obj.h_f;
            out = (1.0./eta.^2.*exp(-z_fluid.*sqrt(eta.^2-h_f.^2)).*sqrt(eta.^2-h_f.^2).*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0i)./b;
        end
        
        function out = integrandPartsGaussEcho(obj,eta)
            a = obj.a;
            b = obj.b;
            z = obj.z1*2-obj.z; % here z = z_fluid
            h_p = obj.h_p;
            k_p = obj.k_p;
            h_f = obj.h_f;
            rho_p = obj.rho_p;
            rho_f = obj.rho_f;
            d = obj.d;
            out = sqrt(eta.^2-h_f.^2).*((1.0./eta.^2.*exp(-z.*sqrt(eta.^2-h_f.^2)).*(a.*besselj(0,a.*eta)-besselj(1,a.*eta)./eta).*((tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0).*(cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0)-(k_p.^8.*rho_f.^2.*1.0./rho_p.^2.*(eta.^2-h_p.^2))./(eta.^2-h_f.^2)).*besselj(1,b.*eta).*-2.0)./(b.*(-cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2+eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p).*(tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p))-(1.0./eta.^2.*exp(-z.*sqrt(eta.^2-h_f.^2)).*(b.*besselj(0,b.*eta)-besselj(1,b.*eta)./eta).*((tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0).*(cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0)-(k_p.^8.*rho_f.^2.*1.0./rho_p.^2.*(eta.^2-h_p.^2))./(eta.^2-h_f.^2)).*besselj(1,a.*eta).*2.0)./(b.*(-cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2+eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p).*(tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p))+(1.0./eta.^2.*exp(-z.*sqrt(eta.^2-h_f.^2)).*besselj(1,a.*eta).*besselj(1,b.*eta).*((cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0).*(eta.*tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).*-8.0+eta.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0+eta.^3.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*1.0./sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+eta.^3.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*1.0./sqrt(eta.^2-k_p.^2).*4.0+d.*eta.^3.*sqrt(eta.^2-h_p.^2).*(tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).^2+1.0).*2.0i-d.*eta.*1.0./sqrt(eta.^2-h_p.^2).*(tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).^2+1.0).*(eta.^2.*2.0-k_p.^2).^2.*5.0e-1i)+(tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0).*(eta.*cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).*-8.0+eta.^3.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*1.0./sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+eta.^3.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*1.0./sqrt(eta.^2-k_p.^2).*4.0-d.*eta.^3.*sqrt(eta.^2-h_p.^2).*(cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).^2+1.0).*2.0i+eta.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0+d.*eta.*1.0./sqrt(eta.^2-h_p.^2).*(cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).^2+1.0).*(eta.^2.*2.0-k_p.^2).^2.*5.0e-1i)+(eta.*k_p.^8.*rho_f.^2.*1.0./rho_p.^2.*2.0)./(eta.^2-h_f.^2)-eta.*k_p.^8.*rho_f.^2.*1.0./rho_p.^2.*1.0./(eta.^2-h_f.^2).^2.*(eta.^2-h_p.^2).*2.0).*2.0)./(b.*(-cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2+eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p).*(tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p))+(1.0./eta.^3.*exp(-z.*sqrt(eta.^2-h_f.^2)).*((tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0).*(cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0)-(k_p.^8.*rho_f.^2.*1.0./rho_p.^2.*(eta.^2-h_p.^2))./(eta.^2-h_f.^2)).*besselj(1,a.*eta).*besselj(1,b.*eta).*4.0)./(b.*(-cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2+eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p).*(tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p))+(1.0./eta.^2.*exp(-z.*sqrt(eta.^2-h_f.^2)).*((tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0).*(cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0)-(k_p.^8.*rho_f.^2.*1.0./rho_p.^2.*(eta.^2-h_p.^2))./(eta.^2-h_f.^2)).*besselj(1,a.*eta).*besselj(1,b.*eta).*1.0./(-cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2+eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p).^2.*(eta.*cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).*-8.0+eta.^3.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*1.0./sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+eta.^3.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*1.0./sqrt(eta.^2-k_p.^2).*4.0-d.*eta.^3.*sqrt(eta.^2-h_p.^2).*(cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).^2+1.0).*2.0i+eta.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0+d.*eta.*1.0./sqrt(eta.^2-h_p.^2).*(cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).^2+1.0).*(eta.^2.*2.0-k_p.^2).^2.*5.0e-1i+(eta.*k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*1.0./sqrt(eta.^2-h_p.^2).*1i)./rho_p-(eta.*k_p.^4.*rho_f.*1.0./(eta.^2-h_f.^2).^(3.0./2.0).*sqrt(eta.^2-h_p.^2).*1i)./rho_p).*2.0)./(b.*(tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p))-(1.0./eta.^2.*exp(-z.*sqrt(eta.^2-h_f.^2)).*((tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0).*(cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0)-(k_p.^8.*rho_f.^2.*1.0./rho_p.^2.*(eta.^2-h_p.^2))./(eta.^2-h_f.^2)).*besselj(1,a.*eta).*besselj(1,b.*eta).*1.0./(tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p).^2.*(eta.*tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).*-8.0+eta.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0+eta.^3.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*1.0./sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+eta.^3.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*1.0./sqrt(eta.^2-k_p.^2).*4.0+d.*eta.^3.*sqrt(eta.^2-h_p.^2).*(tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).^2+1.0).*2.0i-d.*eta.*1.0./sqrt(eta.^2-h_p.^2).*(tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).^2+1.0).*(eta.^2.*2.0-k_p.^2).^2.*5.0e-1i-(eta.*k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*1.0./sqrt(eta.^2-h_p.^2).*1i)./rho_p+(eta.*k_p.^4.*rho_f.*1.0./(eta.^2-h_f.^2).^(3.0./2.0).*sqrt(eta.^2-h_p.^2).*1i)./rho_p).*2.0)./(b.*(-cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2+eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p))+(z.*exp(-z.*sqrt(eta.^2-h_f.^2)).*1.0./sqrt(eta.^2-h_f.^2).*((tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0).*(cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0)-(k_p.^8.*rho_f.^2.*1.0./rho_p.^2.*(eta.^2-h_p.^2))./(eta.^2-h_f.^2)).*besselj(1,a.*eta).*besselj(1,b.*eta).*2.0)./(b.*eta.*(-cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2+eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p).*(tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p))).*1i;
        end
        function out = termPartsGaussEcho(obj,eta)
            a = obj.a;
            b = obj.b;
            z = obj.z1*2-obj.z; % here z = z_fluid
            h_p = obj.h_p;
            k_p = obj.k_p;
            h_f = obj.h_f;
            rho_p = obj.rho_p;
            rho_f = obj.rho_f;
            d = obj.d;
            out = (1.0./eta.^2.*exp(-z.*sqrt(eta.^2-h_f.^2)).*sqrt(eta.^2-h_f.^2).*((tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0).*(cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0)-(k_p.^8.*rho_f.^2.*1.0./rho_p.^2.*(eta.^2-h_p.^2))./(eta.^2-h_f.^2)).*besselj(1,a.*eta).*besselj(1,b.*eta).*-2.0i)./(b.*(-cot(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2+eta.^2.*cot(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p).*(tan(d.*sqrt(eta.^2-h_p.^2).*5.0e-1i).*(eta.^2.*2.0-k_p.^2).^2-eta.^2.*tan(d.*sqrt(eta.^2-k_p.^2).*5.0e-1i).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0+(k_p.^4.*rho_f.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1i)./rho_p));
        end
        
        function out = integrandPartsGaussEcho1(obj,eta)
            a = obj.a;
            b = obj.b;
            z = obj.z1*2-obj.z; % here z = z_fluid
            h_p = obj.h_p;
            k_p = obj.k_p;
            h_f = obj.h_f;
            rho_p = obj.rho_p;
            rho_f = obj.rho_f;
            d = obj.d;
            out = (exp(-z.*sqrt(eta.^2-h_f.^2)).*((1.0./eta.^2.*(a.*besselj(0,a.*eta)-besselj(1,a.*eta)./eta).*besselj(1,b.*eta).*(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*2.0)./(b.*(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i))+(1.0./eta.^2.*(b.*besselj(0,b.*eta)-besselj(1,b.*eta)./eta).*besselj(1,a.*eta).*(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*2.0)./(b.*(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i))-(1.0./eta.^3.*besselj(1,a.*eta).*besselj(1,b.*eta).*(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*4.0)./(b.*(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i))+(1.0./eta.^2.*besselj(1,a.*eta).*besselj(1,b.*eta).*(eta.^3.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1.2e+1i+eta.^5.*h_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*2.0i-eta.^3.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*4.0i-eta.^5.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*1i+eta.^3.*h_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^3.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^3.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-eta.^3.*h_p.^2.*k_p.^2.*rho_f.*1.0./sqrt(eta.^2-h_p.^2).*1i+eta.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*4.0i+eta.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*4.0i-eta.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^3.*h_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i-eta.^3.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1.0./sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i-eta.^3.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1.0./sqrt(eta.^2-k_p.^2).*4.0i+eta.*h_p.^2.*k_p.^2.*rho_f.*1.0./sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i).*2.0)./(b.*(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i))-(1.0./eta.^2.*besselj(1,a.*eta).*besselj(1,b.*eta).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^2.*(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*(eta.^3.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1.2e+1i+eta.^5.*h_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*2.0i-eta.^3.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*4.0i-eta.^5.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*1i+eta.^3.*h_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^3.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^3.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+eta.^3.*h_p.^2.*k_p.^2.*rho_f.*1.0./sqrt(eta.^2-h_p.^2).*1i+eta.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*4.0i+eta.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*4.0i-eta.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^3.*h_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i-eta.^3.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1.0./sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i-eta.^3.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1.0./sqrt(eta.^2-k_p.^2).*4.0i-eta.*h_p.^2.*k_p.^2.*rho_f.*1.0./sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i).*2.0)./b).*-1i)./z;
        end
        function out = termPartsGaussEcho1(obj,eta)
            a = obj.a;
            b = obj.b;
            z = obj.z1*2-obj.z; % here z = z_fluid
            h_p = obj.h_p;
            k_p = obj.k_p;
            h_f = obj.h_f;
            rho_p = obj.rho_p;
            rho_f = obj.rho_f;
            d = obj.d;
            out = (1.0./eta.^2.*exp(-z.*sqrt(eta.^2-h_f.^2)).*besselj(1,a.*eta).*besselj(1,b.*eta).*(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*-2.0i)./(b.*z.*(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i));
        end
        
        function out = integrandPartsGaussEcho2(obj,eta)
            a = obj.a;
            b = obj.b;
            z = obj.z1*2-obj.z; % here z = z_fluid
            h_p = obj.h_p;
            k_p = obj.k_p;
            h_f = obj.h_f;
            rho_p = obj.rho_p;
            rho_f = obj.rho_f;
            d = obj.d;
            out = (exp(-z.*sqrt(eta.^2-h_f.^2)).*((h_p.^4.*k_p.^2.*rho_f.*rho_p.*exp(-d.*(sqrt(eta.^2-h_p.^2).*2.0+sqrt(eta.^2-k_p.^2))).*((eta.^2-k_p.^2).^2-eta.^4).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*besselj(1,a.*eta).*besselj(1,b.*eta).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^3.*(eta.^4.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*3.2e+1)./(b.*eta)+(1.0./eta.^2.*h_p.^2.*k_p.^2.*rho_f.*rho_p.*exp(-d.*(sqrt(eta.^2-h_p.^2).*2.0+sqrt(eta.^2-k_p.^2))).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*besselj(1,a.*eta).*besselj(1,b.*eta).*(eta.*(eta.^2-k_p.^2).*4.0-eta.^3.*4.0).*(k_p.^2.*(eta.^2-h_p.^2)+eta.^2.*h_p.^2.*2.0-eta.^2.*k_p.^2).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^3.*(eta.^4.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*8.0)./b+(1.0./eta.^2.*h_p.^2.*k_p.^2.*rho_f.*rho_p.*exp(-d.*(sqrt(eta.^2-h_p.^2).*2.0+sqrt(eta.^2-k_p.^2))).*((eta.^2-k_p.^2).^2-eta.^4).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*besselj(1,a.*eta).*besselj(1,b.*eta).*(k_p.^2.*(eta.^2-h_p.^2)+eta.^2.*h_p.^2.*2.0-eta.^2.*k_p.^2).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^3.*(eta.^3.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1.2e+1i+eta.^5.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*1.0./sqrt(eta.^2-h_f.^2).*2.0i-eta.^3.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*4.0i-eta.^5.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*1.0./sqrt(eta.^2-h_f.^2).*1i+eta.^3.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^3.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^3.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-eta.^3.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*1.0./sqrt(eta.^2-h_p.^2).*1i+eta.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*4.0i+eta.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*4.0i+eta.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^3.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i-eta.^3.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*1.0./sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i-eta.^3.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1.0./sqrt(eta.^2-k_p.^2).*8.0i+eta.^3.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i+eta.^3.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1.0./sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i+eta.^3.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1.0./sqrt(eta.^2-k_p.^2).*4.0i+eta.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*1.0./sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*1.6e+1i+eta.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i-d.*eta.^3.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-k_p.^2).*8.0i+d.*eta.^3.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*4.0i+d.*eta.^3.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-k_p.^2).*2.0i+d.*eta.^5.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1.0./sqrt(eta.^2-k_p.^2).*2.0i-d.*eta.^3.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-k_p.^2).*1i-d.*eta.^5.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1.0./sqrt(eta.^2-k_p.^2).*1i+d.*eta.^3.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1.0./sqrt(eta.^2-k_p.^2).*1i+d.*eta.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*1i-d.*eta.^3.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*1.0./sqrt(eta.^2-k_p.^2).*1i+d.*eta.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*1i).*8.0)./b+(1.0./eta.^2.*h_p.^2.*k_p.^2.*rho_f.*rho_p.*exp(-d.*(sqrt(eta.^2-h_p.^2).*2.0+sqrt(eta.^2-k_p.^2))).*((eta.^2-k_p.^2).^2-eta.^4).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*(a.*besselj(0,a.*eta)-besselj(1,a.*eta)./eta).*besselj(1,b.*eta).*(k_p.^2.*(eta.^2-h_p.^2)+eta.^2.*h_p.^2.*2.0-eta.^2.*k_p.^2).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^3.*(eta.^4.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*8.0)./b+(1.0./eta.^2.*h_p.^2.*k_p.^2.*rho_f.*rho_p.*exp(-d.*(sqrt(eta.^2-h_p.^2).*2.0+sqrt(eta.^2-k_p.^2))).*((eta.^2-k_p.^2).^2-eta.^4).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*(b.*besselj(0,b.*eta)-besselj(1,b.*eta)./eta).*besselj(1,a.*eta).*(k_p.^2.*(eta.^2-h_p.^2)+eta.^2.*h_p.^2.*2.0-eta.^2.*k_p.^2).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^3.*(eta.^4.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*8.0)./b+(h_p.^2.*k_p.^2.*rho_f.*rho_p.*exp(-d.*(sqrt(eta.^2-h_p.^2).*2.0+sqrt(eta.^2-k_p.^2))).*((eta.^2-k_p.^2).^2-eta.^4).*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*besselj(1,a.*eta).*besselj(1,b.*eta).*(k_p.^2.*(eta.^2-h_p.^2)+eta.^2.*h_p.^2.*2.0-eta.^2.*k_p.^2).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^3.*(eta.^4.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*8.0)./(b.*eta)+(h_p.^2.*k_p.^2.*rho_f.*rho_p.*exp(-d.*(sqrt(eta.^2-h_p.^2).*2.0+sqrt(eta.^2-k_p.^2))).*((eta.^2-k_p.^2).^2-eta.^4).*sqrt(eta.^2-h_f.^2).*1.0./sqrt(eta.^2-h_p.^2).*besselj(1,a.*eta).*besselj(1,b.*eta).*(k_p.^2.*(eta.^2-h_p.^2)+eta.^2.*h_p.^2.*2.0-eta.^2.*k_p.^2).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^3.*(eta.^4.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*8.0)./(b.*eta)-(1.0./eta.^3.*h_p.^2.*k_p.^2.*rho_f.*rho_p.*exp(-d.*(sqrt(eta.^2-h_p.^2).*2.0+sqrt(eta.^2-k_p.^2))).*((eta.^2-k_p.^2).^2-eta.^4).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*besselj(1,a.*eta).*besselj(1,b.*eta).*(k_p.^2.*(eta.^2-h_p.^2)+eta.^2.*h_p.^2.*2.0-eta.^2.*k_p.^2).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^3.*(eta.^4.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*1.6e+1)./b-(1.0./eta.^2.*h_p.^2.*k_p.^2.*rho_f.*rho_p.*exp(-d.*(sqrt(eta.^2-h_p.^2).*2.0+sqrt(eta.^2-k_p.^2))).*((eta.^2-k_p.^2).^2-eta.^4).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*besselj(1,a.*eta).*besselj(1,b.*eta).*(k_p.^2.*(eta.^2-h_p.^2)+eta.^2.*h_p.^2.*2.0-eta.^2.*k_p.^2).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^4.*(eta.^4.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*(eta.^3.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1.2e+1i+eta.^5.*h_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*2.0i-eta.^3.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*4.0i-eta.^5.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*1i+eta.^3.*h_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^3.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^3.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+eta.^3.*h_p.^2.*k_p.^2.*rho_f.*1.0./sqrt(eta.^2-h_p.^2).*1i+eta.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*4.0i+eta.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*4.0i-eta.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.*k_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^3.*h_p.^2.*rho_p.*1.0./sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i-eta.^3.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1.0./sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i-eta.^3.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*1.0./sqrt(eta.^2-k_p.^2).*4.0i-eta.*h_p.^2.*k_p.^2.*rho_f.*1.0./sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i).*2.4e+1)./b-(d.*1.0./eta.^2.*h_p.^2.*k_p.^2.*rho_f.*rho_p.*exp(-d.*(sqrt(eta.^2-h_p.^2).*2.0+sqrt(eta.^2-k_p.^2))).*((eta.^2-k_p.^2).^2-eta.^4).*(eta.*1.0./sqrt(eta.^2-h_p.^2).*2.0+eta.*1.0./sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*besselj(1,a.*eta).*besselj(1,b.*eta).*(k_p.^2.*(eta.^2-h_p.^2)+eta.^2.*h_p.^2.*2.0-eta.^2.*k_p.^2).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^3.*(eta.^4.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*8.0)./b).*1i)./z;
        end
        function out = termPartsGaussEcho2(obj,eta)
            a = obj.a;
            b = obj.b;
            z = obj.z1*2-obj.z; % here z = z_fluid
            h_p = obj.h_p;
            k_p = obj.k_p;
            h_f = obj.h_f;
            rho_p = obj.rho_p;
            rho_f = obj.rho_f;
            d = obj.d;
            out = (1.0./eta.^2.*h_p.^2.*k_p.^2.*rho_f.*rho_p.*exp(-d.*(sqrt(eta.^2-h_p.^2).*2.0+sqrt(eta.^2-k_p.^2))).*exp(-z.*sqrt(eta.^2-h_f.^2)).*((eta.^2-k_p.^2).^2-eta.^4).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*besselj(1,a.*eta).*besselj(1,b.*eta).*(k_p.^2.*(eta.^2-h_p.^2)+eta.^2.*h_p.^2.*2.0-eta.^2.*k_p.^2).*1.0./(eta.^4.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i-h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i+eta.^2.*h_p.^2.*k_p.^2.*rho_f.*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).^3.*(eta.^4.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*2.0i-eta.^4.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*1i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*2.0i+eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*1i-eta.^2.*k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-k_p.^2).*1i+h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*k_p.^2.*rho_f.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_p.^2).*1i+k_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*(eta.^2-h_p.^2).*(eta.^2-k_p.^2).*1i-eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-h_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*8.0i+eta.^2.*h_p.^2.*rho_p.*exp(d.*sqrt(eta.^2-k_p.^2)).*sqrt(eta.^2-h_f.^2).*sqrt(eta.^2-h_p.^2).*sqrt(eta.^2-k_p.^2).*4.0i).*8.0i)./(b.*z);
        end
        
    end
end



